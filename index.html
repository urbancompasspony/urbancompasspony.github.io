<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory & Domain Controller WebUI</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        .header p { font-size: 1.1em; opacity: 0.9;}
        .main-content { padding: 40px; }
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .menu-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border-color: #3498db;
        }
        .menu-card h3 { color: #2c3e50; margin-bottom: 15px; font-size: 1.3em;}
        .menu-card p { color: #7f8c8d; line-height: 1.6;}
        .submenu {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .submenu.active { display: block; }
        .submenu h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        .submenu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        .submenu-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .submenu-item:hover { background: #3498db; color: white;}
        .form-container {
            display: none;
            margin-top: 20px;
            padding: 25px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .form-container.active { display: block; }
        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        .btn {
            background: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
            margin-right: 10px;
        }
        .btn:hover { background: #2980b9;}
        .btn-danger { background: #e74c3c;}
        .btn-danger:hover { background: #c0392b;}
        .btn-success { background: #27ae60;}
        .btn-success:hover { background: #229954;}
        .back-btn {
            background: #95a5a6;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .back-btn:hover { background: #7f8c8d;}
        .result-container {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            display: none;
        }
        .result-container.active { display: block;}
        .result-container pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .loading { display: none; text-align: center; padding: 20px;}
        .loading.active { display: block;}
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
        .alert { padding: 15px; margin-bottom: 20px; border-radius: 6px; display: none;}
        .alert.active { display: block;}
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .checkbox-group input[type="checkbox"],
        .checkbox-group input[type="radio"] {
            width: auto;
            margin-right: 10px;
        }
        .domain-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .domain-info h4 { color: #2c3e50; margin-bottom: 10px;}
        .domain-info p { color: #7f8c8d; margin-bottom: 5px;}
        .instruction-panel {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 22px 24px;
            margin: 18px 0 24px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            display: none;
            max-width: 600px;
        }
        .confirm-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.5); z-index: 9999; display: none;
    align-items: center; justify-content: center;
}
.confirm-overlay.active { display: flex; }
.confirm-box {
    background: white; border-radius: 10px; padding: 25px;
    max-width: 400px; width: 90%; text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}
.confirm-message { font-size: 18px; color: #2c3e50; margin-bottom: 25px; }
.confirm-buttons { display: flex; gap: 15px; justify-content: center; }
.confirm-btn { padding: 12px 25px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; min-width: 80px; }
.confirm-btn-yes { background: #e74c3c; color: white; }
.confirm-btn-no { background: #95a5a6; color: white;
}
/* Melhorias para radio buttons */
.checkbox-group input[type="radio"] {
    width: 18px;
    height: 18px;
    margin-right: 10px;
    accent-color: #3498db;
}

.checkbox-group label {
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
}

.checkbox-group:hover {
    background: rgba(52, 152, 219, 0.1);
    border-radius: 5px;
    padding: 5px;
    margin: -5px;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Active Directory & Domain Controller</h1>
            <p>Interface Web de Administra√ß√£o - v8.0 - 16.06.2025</p>
        </div>

        <div class="main-content">
            <!-- Menu Principal -->
            <div id="main-menu" class="menu-grid">
                <div class="menu-card" onclick="showSubmenu('user-tools')">
                    <h3>üë§ Ferramentas de Usu√°rios</h3>
                    <p>Gerenciar usu√°rios do dom√≠nio: criar, editar, bloquear, alterar senhas e muito mais.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('group-tools')">
                    <h3>üë• Ferramentas de Grupos</h3>
                    <p>Administrar grupos de seguran√ßa e distribui√ß√£o, gerenciar membros e permiss√µes.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('pc-tools')">
                    <h3>üíª Ferramentas de Computadores</h3>
                    <p>Gerenciar computadores do dom√≠nio, adicionar, remover e mover entre OUs.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('shared-folders')">
                    <h3>üìÅ Gest√£o de Pastas Compartilhadas</h3>
                    <p>Criar e gerenciar compartilhamentos de rede, definir permiss√µes e ACLs.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('ou-tools')">
                    <h3>üè¢ Unidades Organizacionais</h3>
                    <p>Criar e gerenciar OUs para organizar objetos do Active Directory.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('auth-silos')">
                    <h3>üîê Silos de Autentica√ß√£o</h3>
                    <p>Configurar silos de autentica√ß√£o para maior seguran√ßa do dom√≠nio.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('domain-info')">
                    <h3>‚ÑπÔ∏è Informa√ß√µes do Dom√≠nio</h3>
                    <p>Visualizar detalhes, sess√µes ativas, compartilhamentos e processos.</p>
                </div>

                <div class="menu-card" onclick="showSubmenu('domain-settings')">
                    <h3>‚öôÔ∏è Configura√ß√µes do Dom√≠nio</h3>
                    <p>Definir pol√≠ticas de senha, ACLs, instalar templates ADMX e muito mais.</p>
                </div>
            </div>

            <!-- Submenu Ferramentas de Usu√°rios -->
            <div id="user-tools" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Ferramentas de Usu√°rios</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="showForm('search-user')">Procurar usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('check-user')">Verificar um usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('create-user')">Criar usu√°rio</div>
                    <div class="submenu-item" onclick="executeCommand('list-users')">Exibir todos os usu√°rios</div>
                    <div class="submenu-item" onclick="showForm('block-user')">Bloquear usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('unblock-user')">Desbloquear usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('add-user-group')">Adicionar usu√°rio a um grupo</div>
                    <div class="submenu-item" onclick="showForm('show-user-groups')">Exibir grupos de usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('remove-user-group')">Remover usu√°rio de um grupo</div>
                    <div class="submenu-item" onclick="showForm('copy-user-groups')">Copiar os grupos de um usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('promote-user')">Promover usu√°rio a admin</div>
                    <div class="submenu-item" onclick="showForm('demote-user')">Demover usu√°rio de admin</div>
                    <div class="submenu-item" onclick="showForm('change-password')">Alterar a senha de um usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('verify-password')">Verificar a senha de um usu√°rio</div>
                    <div class="submenu-item" onclick="showForm('password-expiry')">A senha do usu√°rio N√ÉO deve expirar?</div>
                    <div class="submenu-item" onclick="showForm('password-expiry-days')">Quando a senha usu√°rio vai expirar?</div>
                    <div class="submenu-item" onclick="showForm('force-password-change')">For√ßar a troca de senha imediata!</div>
                    <div class="submenu-item" onclick="showForm('account-expiry')">Usu√°rio deve expirar?</div>
                    <div class="submenu-item" onclick="showForm('move-user-ou')">Mover usu√°rio para OU</div>
                    <div class="submenu-item" onclick="showForm('delete-user')">Cuidado: Excluir um usu√°rio</div>
                </div>
            </div>

            <!-- Submenu Ferramentas de Grupos -->
            <div id="group-tools" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Ferramentas de Grupos</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="showForm('search-group')">Procurar grupo</div>
                    <div class="submenu-item" onclick="showForm('check-group')">Verificar um Grupo</div>
                    <div class="submenu-item" onclick="showForm('create-group')">Criar grupo</div>
                    <div class="submenu-item" onclick="executeCommand('list-groups')">Exibir todos os grupos</div>
                    <div class="submenu-item" onclick="showForm('show-group-members')">Exibir membros de um grupo</div>
                    <div class="submenu-item" onclick="showForm('copy-group-members')">Copiar os membros de um grupo</div>
                    <div class="submenu-item" onclick="showForm('add-group-to-group')">Adicionar grupo 1 a um grupo 2</div>
                    <div class="submenu-item" onclick="showForm('remove-group-from-group')">Remover grupo 1 de um grupo 2</div>
                    <div class="submenu-item" onclick="showForm('move-group-ou')">Mover grupo para OU</div>
                    <div class="submenu-item" onclick="showForm('delete-group')">Cuidado: Excluir um grupo</div>
                </div>
            </div>

            <!-- Submenu Ferramentas de Computadores -->
            <div id="pc-tools" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Ferramentas de Computadores</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="showForm('search-computer')">Procurar computador</div>
                    <div class="submenu-item" onclick="showForm('check-computer')">Verificar um computador</div>
                    <div class="submenu-item" onclick="executeCommand('list-computers')">Exibir todos os computadores</div>
                    <div class="submenu-item" onclick="showForm('create-computer')">Criar/Adicionar um computador</div>
                    <div class="submenu-item" onclick="showForm('move-computer-ou')">Mover computador para OU</div>
                    <div class="submenu-item" onclick="showForm('delete-computer')">Cuidado: Excluir um computador</div>
                </div>
            </div>

            <!-- Submenu Gest√£o de Pastas Compartilhadas -->
            <div id="shared-folders" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Gest√£o de Pastas Compartilhadas</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="executeCommand('show-shares')">Mostrar pastas compartilhadas</div>
                    <div class="submenu-item" onclick="showForm('create-share')">Criar nova pasta compartilhada</div>
                    <div class="submenu-item" onclick="showForm('create-sync-share')">Compartilhamento estruturado</div>
                    <div class="submenu-item" onclick="showForm('delete-share')">Excluir compartilhamento</div>
                    <div class="submenu-item" onclick="executeCommand('revalidate-shares')">Revalidar configura√ß√µes</div>
                </div>
            </div>

            <!-- Submenu Unidades Organizacionais -->
            <div id="ou-tools" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Unidades Organizacionais</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="executeCommand('list-ous')">Listar todas as OUs</div>
                    <div class="submenu-item" onclick="showForm('create-ou')">Criar uma OU</div>
                    <div class="submenu-item" onclick="showForm('list-ou-objects')">Listar objetos de OU</div>
                    <div class="submenu-item" onclick="showForm('delete-ou')">Excluir uma OU</div>
                </div>
            </div>

            <!-- Submenu Silos de Autentica√ß√£o -->
            <div id="auth-silos" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Silos de Autentica√ß√£o</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="showForm('check-silo')">Procurar/verificar um silo</div>
                    <div class="submenu-item" onclick="executeCommand('list-silos')">Listar todos os silos</div>
                    <div class="submenu-item" onclick="showForm('create-silo')">Criar um silo</div>
                    <div class="submenu-item" onclick="showForm('list-silo-users')">Listar usu√°rios de um silo</div>
                    <div class="submenu-item" onclick="showForm('add-user-silo')">Adicionar um usu√°rio a um silo</div>
                    <div class="submenu-item" onclick="showForm('remove-user-silo')">Remover um usu√°rio de um silo</div>
                    <div class="submenu-item" onclick="showForm('delete-silo')">Excluir um silo</div>
                </div>
            </div>

            <!-- Submenu Informa√ß√µes do Dom√≠nio -->
            <div id="domain-info" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Informa√ß√µes do Dom√≠nio</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="executeCommand('show-domain-info')">Detalhes deste Dom√≠nio</div>
                    <div class="submenu-item" onclick="executeCommand('show-domain-level')">N√≠vel funcional do dom√≠nio</div>
                    <div class="submenu-item" onclick="executeCommand('show-fsmo-roles')">Fun√ß√µes FSMO</div>
                    <div class="submenu-item" onclick="executeCommand('show-sites')">Sites de replica√ß√£o</div>
                    <div class="submenu-item" onclick="executeCommand('show-replication-info')">Informa√ß√µes de replica√ß√£o</div>
                    <div class="submenu-item" onclick="executeCommand('active-sessions')">Status das Sess√µes ativas</div>
                    <div class="submenu-item" onclick="executeCommand('active-shares')">Status dos Compartilhamentos</div>
                    <div class="submenu-item" onclick="executeCommand('samba-processes')">Processos do SAMBA-AD-DC</div>
                </div>
            </div>

            <!-- Submenu Configura√ß√µes do Dom√≠nio -->
            <div id="domain-settings" class="submenu">
                <button class="back-btn" onclick="showMainMenu()">‚Üê Voltar</button>
                <h3>Configura√ß√µes do Dom√≠nio</h3>
                <div class="submenu-grid">
                    <div class="submenu-item" onclick="showForm('password-policy')">Regras de Senhas</div>
                    <div class="submenu-item" onclick="showForm('permissions')">Permiss√µes Comuns</div>
                    <div class="submenu-item" onclick="showForm('acls')">Cuidado: ACLs</div>
                    <div class="submenu-item" onclick="executeCommand('install-admx-w10')">Instalar ADMX Templates extras W 10</div>
                    <div class="submenu-item" onclick="executeCommand('install-admx-w11')">Instalar ADMX Templates extras W 11</div>
                    <div class="submenu-item" onclick="executeCommand('remove-admx')">Remover ADMX Templates extras</div>
                    <div class="submenu-item" onclick="executeCommand('update-menu')">Atualizar este Menu!</div>
                </div>
            </div>

            <!-- √Årea de Formul√°rios -->
            <div id="form-area">
                <!-- Formul√°rio Criar Usu√°rio -->
                <div id="create-user-form" class="form-container">
                    <h3>Criar Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'create-user')">
                        <div class="form-group">
                            <label for="username">Nome do Usu√°rio:</label>
                            <input type="text" id="username" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="display-name">Nome de Exibi√ß√£o:</label>
                            <input type="text" id="display-name" name="display-name" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Senha:</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="must-change-password" name="must-change-password">
                            <label for="must-change-password">Usu√°rio deve trocar senha no pr√≥ximo login</label>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Usu√°rio</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Buscar Usu√°rio -->
                <div id="search-user-form" class="form-container">
                    <h3>Buscar Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'search-user')">
                        <div class="form-group">
                            <label for="search-username">Nome do Usu√°rio (ou parte do nome):</label>
                            <input type="text" id="search-username" name="search-term" required>
                        </div>
                        <button type="submit" class="btn">Buscar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Verificar Usu√°rio -->
                <div id="check-user-form" class="form-container">
                    <h3>Verificar Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'check-user')">
                        <div class="form-group">
                            <label for="check-username">Nome do Usu√°rio:</label>
                            <input type="text" id="check-username" name="username" required>
                        </div>
                        <button type="submit" class="btn">Verificar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Bloquear Usu√°rio -->
                <div id="block-user-form" class="form-container">
                    <h3>Bloquear Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'disable-user')">
                        <div class="form-group">
                            <label for="block-username">Nome do Usu√°rio:</label>
                            <input type="text" id="block-username" name="username" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Bloquear Usu√°rio</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Desbloquear Usu√°rio -->
                <div id="unblock-user-form" class="form-container">
                    <h3>Desbloquear Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'enable-user')">
                        <div class="form-group">
                            <label for="unblock-username">Nome do Usu√°rio:</label>
                            <input type="text" id="unblock-username" name="username" required>
                        </div>
                        <button type="submit" class="btn btn-success">Desbloquear Usu√°rio</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Alterar Senha -->
                <div id="change-password-form" class="form-container">
                    <h3>Alterar Senha do Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'reset-password')">
                        <div class="form-group">
                            <label for="change-pass-username">Nome do Usu√°rio:</label>
                            <input type="text" id="change-pass-username" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="new-password">Nova Senha:</label>
                            <input type="password" id="new-password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-success">Alterar Senha</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Deletar Usu√°rio -->
                <div id="delete-user-form" class="form-container">
                    <h3>Deletar Usu√°rio</h3>
                    <div class="alert alert-error active">
                        <strong>Aten√ß√£o!</strong> Esta a√ß√£o √© irrevers√≠vel.
                    </div>
                        <form onsubmit="confirmDeleteUser(event)">
                        <div class="form-group">
                            <label for="delete-username">Nome do Usu√°rio:</label>
                            <input type="text" id="delete-username" name="username" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Deletar Usu√°rio</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

<!-- Formul√°rio Verificar Senha do Usu√°rio -->
<!-- Formul√°rio Expira√ß√£o de Senha -->
<div id="password-expiry-form" class="form-container">
    <h3>Configurar Expira√ß√£o de Senha</h3>
    <form onsubmit="handlePasswordExpiry(event)">
        <div class="form-group">
            <label for="expiry-username">Nome do Usu√°rio:</label>
            <input type="text" id="expiry-username" name="username" required>
        </div>
        <button type="submit" class="btn btn-success">Configurar Expira√ß√£o</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

<!-- Formul√°rio Dias para Expirar -->
<div id="password-expiry-days-form" class="form-container">
    <h3>Definir Dias para Expira√ß√£o</h3>
    <form onsubmit="submitForm(event, 'password-expiry-days')">
        <div class="form-group">
            <label for="expiry-days-username">Nome do Usu√°rio:</label>
            <input type="text" id="expiry-days-username" name="username" required>
        </div>
        <div class="form-group">
            <label for="expiry-days">Dias para expira√ß√£o:</label>
            <input type="number" id="expiry-days" name="days" min="0" required>
        </div>
        <button type="submit" class="btn btn-success">Definir Prazo</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

<!-- Formul√°rio Definir Expira√ß√£o da Conta -->
<div id="account-expiry-form" class="form-container">
    <h3>Usu√°rio deve expirar?</h3>
    <form onsubmit="handleAccountExpiry(event)">
        <div class="form-group">
            <label for="account-expiry-username">Nome do Usu√°rio:</label>
            <input type="text" id="account-expiry-username" name="username" required>
        </div>

        <div class="form-group">
            <label style="font-weight: 600; color: #2c3e50; margin-bottom: 15px; display: block;">Op√ß√µes de Expira√ß√£o:</label>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <div class="checkbox-group" style="margin-bottom: 15px;">
                    <input type="radio" id="expiry-date-option" name="expiry-type" value="date" checked onchange="toggleExpiryFields()">
                    <label for="expiry-date-option" style="font-weight: normal;">üìÖ Definir data espec√≠fica de expira√ß√£o</label>
                </div>

                <div id="date-field" style="margin-left: 25px; margin-bottom: 15px;">
                    <label for="account-expiry-date" style="font-size: 14px; color: #666;">Data de expira√ß√£o:</label>
                    <input type="date" id="account-expiry-date" name="expiry-date" style="margin-top: 5px;">
                    <small style="color: #666; display: block; margin-top: 5px;">A conta ser√° desabilitada nesta data</small>
                </div>

                <div class="checkbox-group">
                    <input type="radio" id="never-expire-option" name="expiry-type" value="never" onchange="toggleExpiryFields()">
                    <label for="never-expire-option" style="font-weight: normal;">‚àû Conta nunca expira</label>
                </div>
                <small style="color: #666; display: block; margin-left: 25px; margin-top: 5px;">A conta permanecer√° ativa indefinidamente</small>
            </div>
        </div>

        <button type="submit" class="btn btn-success">Configurar Expira√ß√£o</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

<!-- Formul√°rio For√ßar Troca de Senha -->
<div id="force-password-change-form" class="form-container">
    <h3>For√ßar Troca de Senha Imediata</h3>
    <form onsubmit="submitForm(event, 'force-password-change')">
        <div class="form-group">
            <label for="force-change-username">Nome do Usu√°rio:</label>
            <input type="text" id="force-change-username" name="username" required>
        </div>
        <button type="submit" class="btn btn-danger">For√ßar Troca Imediata</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

<div id="verify-password-form" class="form-container">
    <h3>Verificar Senha do Usu√°rio</h3>
    <form onsubmit="submitForm(event, 'verify-password')">
        <div class="form-group">
            <label for="verify-username">Nome do Usu√°rio:</label>
            <input type="text" id="verify-username" name="username" required>
        </div>
        <div class="form-group">
            <label for="verify-password">Senha:</label>
            <input type="password" id="verify-password" name="password" required>
        </div>
        <button type="submit" class="btn btn-info">Verificar Senha</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

                <!-- Formul√°rio Criar Grupo -->
                <div id="create-group-form" class="form-container">
                    <h3>Criar Grupo</h3>
                    <form onsubmit="submitForm(event, 'create-group')">
                        <div class="form-group">
                            <label for="group-name">Nome do Grupo:</label>
                            <input type="text" id="group-name" name="group" required>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Grupo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Adicionar Usu√°rio ao Grupo -->
                <div id="add-user-group-form" class="form-container">
                    <h3>Adicionar Usu√°rio ao Grupo</h3>
                    <form onsubmit="submitForm(event, 'add-user-to-group')">
                        <div class="form-group">
                            <label for="user-for-group">Nome do Usu√°rio:</label>
                            <input type="text" id="user-for-group" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="target-group">Nome do Grupo:</label>
                            <input type="text" id="target-group" name="group" required>
                        </div>
                        <button type="submit" class="btn btn-success">Adicionar ao Grupo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Copiar Membros de Grupo -->
<div id="copy-group-members-form" class="form-container">
    <h3>Copiar Membros de um Grupo</h3>
    <div class="instruction-panel" style="display: block; background: #e8f4fd; border-left: 4px solid #2196F3;">
        <h4 style="color: #1976D2; margin-bottom: 10px;">üí° Como funciona:</h4>
        <p style="margin-bottom: 8px;">‚Ä¢ <strong>Grupo de Origem:</strong> De onde copiar os membros</p>
        <p style="margin-bottom: 8px;">‚Ä¢ <strong>Grupo de Destino:</strong> Para onde copiar os membros</p>
        <p style="margin-bottom: 8px;">‚Ä¢ <strong>Resultado:</strong> Todos os membros do grupo origem ser√£o adicionados ao grupo destino</p>
        <p style="color: #666; font-size: 14px;">‚ö†Ô∏è Membros j√° existentes no destino ser√£o ignorados (sem erro)</p>
    </div>
    
    <form onsubmit="submitForm(event, 'copy-group-members')">
        <div class="form-group">
            <label for="source-group">Grupo de Origem (copiar membros DE):</label>
            <input type="text" id="source-group" name="source-group" placeholder="ex: Vendas" required>
            <small style="color: #666;">Nome do grupo que possui os membros a serem copiados</small>
        </div>
        
        <div class="form-group">
            <label for="target-group">Grupo de Destino (copiar membros PARA):</label>
            <input type="text" id="target-group" name="target-group" placeholder="ex: Marketing" required>
            <small style="color: #666;">Nome do grupo que receber√° os membros copiados</small>
        </div>
        
        <div style="background: #fff3cd; padding: 15px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #ffc107;">
            <h5 style="color: #856404; margin: 0 0 8px 0;">‚ö†Ô∏è Exemplo pr√°tico:</h5>
            <p style="color: #856404; margin: 0; font-size: 14px;">
                Se "Vendas" tem os membros: jo√£o, maria, pedro<br>
                E "Marketing" tem: ana, carlos<br>
                <strong>Resultado:</strong> "Marketing" ficar√° com: ana, carlos, jo√£o, maria, pedro
            </p>
        </div>
        
        <button type="submit" class="btn btn-success">üîÑ Copiar Membros do Grupo</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

                <!-- Formul√°rio Criar Compartilhamento -->
                <div id="create-share-form" class="form-container">
                    <h3>Criar Nova Pasta Compartilhada</h3>
                    <form onsubmit="submitForm(event, 'create-share')">
                        <div class="form-group">
                            <label for="share-name">Nome do Compartilhamento:</label>
                            <input type="text" id="share-name" name="share-name" placeholder="nome_do_compartilhamento" required>
                        </div>
                        <div class="form-group">
                            <label for="share-path">Caminho (/mnt):</label>
                            <input type="text" id="share-path" name="share-path" placeholder="/pasta_compartilhada" required>
                        </div>
                        <div class="form-group">
                            <label for="share-users">Grupos/Usu√°rios (separados por v√≠rgula):</label>
                            <input type="text" id="share-users" name="share-users" placeholder="@grupo, usuario" required>
                        </div>
                        <div class="form-group">
                            <label for="share-writable">Grav√°vel:</label>
                            <select id="share-writable" name="writable">
                                <option value="yes">Sim</option>
                                <option value="no">N√£o</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="share-browsable">Naveg√°vel:</label>
                            <select id="share-browsable" name="browsable">
                                <option value="yes">Sim</option>
                                <option value="no">N√£o</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Compartilhamento</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Criar Compartilhamento Sync -->
                <div id="create-sync-share-form" class="form-container">
                    <h3>Compartilhamento Estruturado (Sync Center)</h3>
                    <form onsubmit="submitForm(event, 'create-sync-share')">
                        <div class="form-group">
                            <label for="sync-share-name">Nome do Compartilhamento:</label>
                            <input type="text" id="sync-share-name" name="share-name" placeholder="nome_do_compartilhamento" required>
                        </div>
                        <div class="form-group">
                            <label for="sync-share-path">Caminho (/mnt):</label>
                            <input type="text" id="sync-share-path" name="share-path" placeholder="/pasta_sync" required>
                        </div>
                        <div class="form-group">
                            <label for="sync-share-users">Grupos/Usu√°rios (separados por v√≠rgula):</label>
                            <input type="text" id="sync-share-users" name="share-users" placeholder="@Sync, @Desativar_Sync" required>
                        </div>
                        <div class="form-group">
                            <label for="sync-share-browsable">Naveg√°vel:</label>
                            <select id="sync-share-browsable" name="browsable">
                                <option value="no">N√£o</option>
                                <option value="yes">Sim</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Compartilhamento Sync</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Deletar Compartilhamento -->
                <div id="delete-share-form" class="form-container">
                    <h3>Excluir Compartilhamento</h3>
                    <div class="alert alert-warning active">
                        <strong>Aten√ß√£o!</strong> Os dados n√£o s√£o apagados, apenas o compartilhamento ser√° removido.
                    </div>
                    <form onsubmit="confirmDeleteShare(event)">
                        <div class="form-group">
                            <label for="delete-share-name">Nome do Compartilhamento:</label>
                            <input type="text" id="delete-share-name" name="share-name" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Excluir Compartilhamento</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Criar OU -->
                <div id="create-ou-form" class="form-container">
                    <h3>Criar Unidade Organizacional</h3>
                    <form onsubmit="submitForm(event, 'create-ou')">
                        <div class="form-group">
                            <label for="ou-name">Nome da OU:</label>
                            <input type="text" id="ou-name" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Criar OU</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Listar Objetos da OU -->
                <div id="list-ou-objects-form" class="form-container">
                    <h3>Listar Objetos da OU</h3>
                    <form onsubmit="submitForm(event, 'list-ou-objects')">
                        <div class="form-group">
                            <label for="list-ou-name">Nome da OU:</label>
                            <input type="text" id="list-ou-name" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn">Listar Objetos</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Deletar OU -->
                <div id="delete-ou-form" class="form-container">
                    <h3>Excluir Unidade Organizacional</h3>
                    <div class="alert alert-warning active">
                        <strong>Aten√ß√£o!</strong> A OU s√≥ ser√° removida se estiver vazia.
                    </div>
                    <form onsubmit="confirmDeleteOU(event)">
                        <div class="form-group">
                            <label for="delete-ou-name">Nome da OU:</label>
                            <input type="text" id="delete-ou-name" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Excluir OU</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Mover Usu√°rio para OU -->
                <div id="move-user-ou-form" class="form-container">
                    <h3>Mover Usu√°rio para OU</h3>
                    <form onsubmit="submitForm(event, 'move-user-ou')">
                        <div class="form-group">
                            <label for="move-user-name">Nome do Usu√°rio:</label>
                            <input type="text" id="move-user-name" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="move-user-target-ou">Nome da OU de Destino:</label>
                            <input type="text" id="move-user-target-ou" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Mover Usu√°rio</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Mover Grupo para OU -->
                <div id="move-group-ou-form" class="form-container">
                    <h3>Mover Grupo para OU</h3>
                    <form onsubmit="submitForm(event, 'move-group-ou')">
                        <div class="form-group">
                            <label for="move-group-name">Nome do Grupo:</label>
                            <input type="text" id="move-group-name" name="group" required>
                        </div>
                        <div class="form-group">
                            <label for="move-group-target-ou">Nome da OU de Destino:</label>
                            <input type="text" id="move-group-target-ou" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Mover Grupo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Mover Computador para OU -->
                <div id="move-computer-ou-form" class="form-container">
                    <h3>Mover Computador para OU</h3>
                    <form onsubmit="submitForm(event, 'move-computer-ou')">
                        <div class="form-group">
                            <label for="move-computer-name">Nome do Computador (sem $):</label>
                            <input type="text" id="move-computer-name" name="computer" required>
                        </div>
                        <div class="form-group">
                            <label for="move-computer-target-ou">Nome da OU de Destino:</label>
                            <input type="text" id="move-computer-target-ou" name="ou-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Mover Computador</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Criar Computador -->
                <div id="create-computer-form" class="form-container">
                    <h3>Criar/Adicionar Computador</h3>
                    <form onsubmit="submitForm(event, 'add-computer')">
                        <div class="form-group">
                            <label for="computer-name">Nome do Computador (sem $):</label>
                            <input type="text" id="computer-name" name="computer" required>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Computador</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Buscar Computador -->
                <div id="search-computer-form" class="form-container">
                    <h3>Buscar Computador</h3>
                    <form onsubmit="submitForm(event, 'search-computer')">
                        <div class="form-group">
                            <label for="search-computer-name">Nome do Computador (sem $):</label>
                            <input type="text" id="search-computer-name" name="search-term" required>
                        </div>
                        <button type="submit" class="btn">Buscar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Verificar Computador -->
                <div id="check-computer-form" class="form-container">
                    <h3>Verificar Computador</h3>
                    <form onsubmit="submitForm(event, 'check-computer')">
                        <div class="form-group">
                            <label for="check-computer-name">Nome do Computador (sem $):</label>
                            <input type="text" id="check-computer-name" name="computer" required>
                        </div>
                        <button type="submit" class="btn">Verificar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Deletar Computador -->
                <div id="delete-computer-form" class="form-container">
                    <h3>Excluir Computador</h3>
                    <div class="alert alert-error active">
                        <strong>Aten√ß√£o!</strong> Esta a√ß√£o √© irrevers√≠vel.
                    </div>
                    <form onsubmit="confirmDeleteComputer(event)">
                        <div class="form-group">
                            <label for="delete-computer-name">Nome do Computador (sem $):</label>
                            <input type="text" id="delete-computer-name" name="computer" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Excluir Computador</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Criar Silo -->
                <div id="create-silo-form" class="form-container">
                    <h3>Criar Silo de Autentica√ß√£o</h3>
                    <form onsubmit="submitForm(event, 'create-silo')">
                        <div class="form-group">
                            <label for="silo-name">Nome do Silo:</label>
                            <input type="text" id="silo-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Criar Silo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Verificar Silo -->
                <div id="check-silo-form" class="form-container">
                    <h3>Procurar/Verificar Silo</h3>
                    <form onsubmit="submitForm(event, 'check-silo')">
                        <div class="form-group">
                            <label for="check-silo-name">Nome do Silo:</label>
                            <input type="text" id="check-silo-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn">Verificar Silo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Listar Usu√°rios do Silo -->
                <div id="list-silo-users-form" class="form-container">
                    <h3>Listar Usu√°rios do Silo</h3>
                    <form onsubmit="submitForm(event, 'list-silo-users')">
                        <div class="form-group">
                            <label for="list-silo-name">Nome do Silo:</label>
                            <input type="text" id="list-silo-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn">Listar Usu√°rios</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Adicionar Usu√°rio ao Silo -->
                <div id="add-user-silo-form" class="form-container">
                    <h3>Adicionar Usu√°rio ao Silo</h3>
                    <form onsubmit="submitForm(event, 'add-user-silo')">
                        <div class="form-group">
                            <label for="silo-user-name">Nome do Usu√°rio:</label>
                            <input type="text" id="silo-user-name" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="silo-target-name">Nome do Silo:</label>
                            <input type="text" id="silo-target-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn btn-success">Adicionar ao Silo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Remover Usu√°rio do Silo -->
                <div id="remove-user-silo-form" class="form-container">
                    <h3>Remover Usu√°rio do Silo</h3>
                    <form onsubmit="submitForm(event, 'remove-user-silo')">
                        <div class="form-group">
                            <label for="remove-silo-user-name">Nome do Usu√°rio:</label>
                            <input type="text" id="remove-silo-user-name" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="remove-silo-target-name">Nome do Silo:</label>
                            <input type="text" id="remove-silo-target-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Remover do Silo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rio Deletar Silo -->
                <div id="delete-silo-form" class="form-container">
                    <h3>Excluir Silo</h3>
                    <div class="alert alert-error active">
                        <strong>Aten√ß√£o!</strong> Esta a√ß√£o √© irrevers√≠vel.
                    </div>
                    <form onsubmit="confirmDeleteSilo(event)">
                        <div class="form-group">
                            <label for="delete-silo-name">Nome do Silo:</label>
                            <input type="text" id="delete-silo-name" name="silo-name" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Excluir Silo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rios de Grupos -->
                <div id="search-group-form" class="form-container">
                    <h3>Buscar Grupo</h3>
                    <form onsubmit="submitForm(event, 'search-group')">
                        <div class="form-group">
                            <label for="search-group-name">Nome do Grupo (ou parte do nome):</label>
                            <input type="text" id="search-group-name" name="search-term" required>
                        </div>
                        <button type="submit" class="btn">Buscar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="check-group-form" class="form-container">
                    <h3>Verificar Grupo</h3>
                    <form onsubmit="submitForm(event, 'check-group')">
                        <div class="form-group">
                            <label for="check-group-name">Nome do Grupo:</label>
                            <input type="text" id="check-group-name" name="group" required>
                        </div>
                        <button type="submit" class="btn">Verificar</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="show-group-members-form" class="form-container">
                    <h3>Exibir Membros do Grupo</h3>
                    <form onsubmit="submitForm(event, 'list-group-members')">
                        <div class="form-group">
                            <label for="show-group-name">Nome do Grupo:</label>
                            <input type="text" id="show-group-name" name="group" required>
                        </div>
                        <button type="submit" class="btn">Listar Membros</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="delete-group-form" class="form-container">
                    <h3>Excluir Grupo</h3>
                    <div class="alert alert-error active">
                        <strong>Aten√ß√£o!</strong> Esta a√ß√£o √© irrevers√≠vel.
                    </div>
                    <form onsubmit="confirmDeleteGroup(event)">
                        <div class="form-group">
                            <label for="delete-group-name">Nome do Grupo:</label>
                            <input type="text" id="delete-group-name" name="group" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Excluir Grupo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

<!-- Formul√°rio Copiar Grupos de Usu√°rio -->
<div id="copy-user-groups-form" class="form-container">
    <h3>Copiar Grupos de um Usu√°rio</h3>
    <form onsubmit="submitForm(event, 'copy-user-groups')">
        <div class="form-group">
            <label for="source-username">Usu√°rio de Origem (copiar grupos DE):</label>
            <input type="text" id="source-username" name="source-username" required>
        </div>
        <div class="form-group">
            <label for="target-username">Usu√°rio de Destino (copiar grupos PARA):</label>
            <input type="text" id="target-username" name="target-username" required>
        </div>
        <button type="submit" class="btn btn-success">Copiar Grupos</button>
        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
    </form>
</div>

                <!-- Formul√°rios Adicionais para Usu√°rios -->
                <div id="show-user-groups-form" class="form-container">
                    <h3>Exibir Grupos do Usu√°rio</h3>
                    <form onsubmit="submitForm(event, 'show-user-groups')">
                        <div class="form-group">
                            <label for="show-groups-username">Nome do Usu√°rio:</label>
                            <input type="text" id="show-groups-username" name="username" required>
                        </div>
                        <button type="submit" class="btn">Exibir Grupos</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="remove-user-group-form" class="form-container">
                    <h3>Remover Usu√°rio do Grupo</h3>
                    <form onsubmit="submitForm(event, 'remove-user-from-group')">
                        <div class="form-group">
                            <label for="remove-user-name">Nome do Usu√°rio:</label>
                            <input type="text" id="remove-user-name" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="remove-from-group">Nome do Grupo:</label>
                            <input type="text" id="remove-from-group" name="group" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Remover do Grupo</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="promote-user-form" class="form-container">
                    <h3>Promover Usu√°rio a Admin</h3>
                    <form onsubmit="submitForm(event, 'promote-user')">
                        <div class="form-group">
                            <label for="promote-username">Nome do Usu√°rio:</label>
                            <input type="text" id="promote-username" name="username" required>
                        </div>
                        <button type="submit" class="btn btn-success">Promover a Admin</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <div id="demote-user-form" class="form-container">
                    <h3>Demover Usu√°rio de Admin</h3>
                    <form onsubmit="submitForm(event, 'demote-user')">
                        <div class="form-group">
                            <label for="demote-username">Nome do Usu√°rio:</label>
                            <input type="text" id="demote-username" name="username" required>
                        </div>
                        <button type="submit" class="btn btn-danger">Demover de Admin</button>
                        <button type="button" class="btn" onclick="hideForm()">Cancelar</button>
                    </form>
                </div>

                <!-- Formul√°rios de Pol√≠tica de Senha -->
                <div id="password-policy-form" class="form-container">
                    <h3>Configura√ß√µes de Pol√≠tica de Senha</h3>
                    <div class="submenu-grid">
                        <div class="submenu-item" onclick="executeCommand('show-password-policy')">Mostrar Status das Regras de Senhas</div>
                        <div class="submenu-item" onclick="executeCommand('enable-complexity')">Ativar complexidade das senhas</div>
                        <div class="submenu-item" onclick="executeCommand('disable-complexity')">Desativar complexidade das senhas</div>
                        <div class="submenu-item" onclick="showForm('password-history')">Tamanho do hist√≥rico das senhas</div>
                        <div class="submenu-item" onclick="showForm('password-min-length')">Tamanho m√≠nimo das senhas</div>
                        <div class="submenu-item" onclick="showForm('password-min-age')">Validade m√≠nima das senhas</div>
                        <div class="submenu-item" onclick="showForm('password-max-age')">Validade m√°xima das senhas</div>
                        <div class="submenu-item" onclick="showForm('login-attempts')">Tentativas de login antes de bloquear</div>
                    </div>
                    <button type="button" class="btn" onclick="backToDomainSettings()">Voltar</button>
                </div>

                <!-- Formul√°rios de Permiss√µes -->
                <div id="permissions-form" class="form-container">
                    <h3>Permiss√µes Comuns</h3>
                    <div class="submenu-grid">
                        <div class="submenu-item" onclick="executeCommand('sysvol-check')">SysVol check status</div>
                        <div class="submenu-item" onclick="executeCommand('sysvol-reset')">SysVol reset permissions</div>
                        <div class="submenu-item" onclick="executeCommand('db-check-general')">samba-ad-dc db check: general</div>
                        <div class="submenu-item" onclick="executeCommand('db-check-acls')">samba-ad-dc db check: well-known-acls</div>
                    </div>
                    <button type="button" class="btn" onclick="backToDomainSettings()">Voltar</button>
                </div>

                <!-- Formul√°rios de ACLs -->
                <div id="acls-form" class="form-container">
                    <h3>Gerenciamento de ACLs</h3>
                    <div class="alert alert-warning active">
                        <strong>Cuidado!</strong> Prefira rodar este comando nas m√°quinas locais: icacls C:\caminho\do\usuario /reset /t /c
                    </div>
                    <div class="submenu-grid">
                        <div class="submenu-item" onclick="executeCommand('check-acl')">Verificar ACL padr√£o (Administrator!)</div>
                        <div class="submenu-item" onclick="showForm('get-acls')">Coletar ACLs de arquivo ou pasta</div>
                        <div class="submenu-item" onclick="showForm('set-acls')">PERIGO! Definir uma ACL a um arquivo ou pasta</div>
                    </div>
                    <button type="button" class="btn" onclick="backToDomainSettings()">Voltar</button>
                </div>

            </div>

            <!-- Loading -->
            <div class="loading">
                <div class="spinner"></div>
                <p>Processando comando...</p>
            </div>

            <!-- Result Container -->
            <div class="result-container">
                <h4>Resultado:</h4>
                <div class="result-content"></div>
            </div>

            <!-- Alert Container -->
            <div class="alert"></div>

        </div>
    </div>

    <script>
        // URL do script CGI
        const CGI_URL = '/cgi-bin/samba-admin.cgi';

        // Elementos DOM
        let loadingElement = null;
        let resultContainer = null;
        let alertContainer = null;

        // Inicializar elementos quando DOM carregar
        document.addEventListener('DOMContentLoaded', function() {
            createUIElements();
            showMainMenu();
        });

        // Criar elementos de UI din√¢micos
        function createUIElements() {
            loadingElement = document.querySelector('.loading');
            resultContainer = document.querySelector('.result-container');
            alertContainer = document.querySelector('.alert');
        }

function showLoading() {
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.style.display = 'block';
    }
    hideAlert();
    hideResult();
}

function hideLoading() {
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.style.display = 'none';
    }
}

function showResult(content, isError = false) {
    const resultContainer = document.querySelector('.result-container');
    if (resultContainer) {
        resultContainer.style.display = 'block';
        resultContainer.innerHTML = `<h4>Resultado:</h4><div class="result-content">${content}</div>`;
        
        if (isError) {
            resultContainer.style.borderLeftColor = '#e74c3c';
        } else {
            resultContainer.style.borderLeftColor = '#3498db';
        }
    }
}

function hideResult() {
    const resultContainer = document.querySelector('.result-container');
    if (resultContainer) {
        resultContainer.style.display = 'none';
    }
}

        // Mostrar alerta
        function showAlert(message, type = 'success') {
            alertContainer.textContent = message;
            alertContainer.className = `alert alert-${type} active`;

            // Auto-hide ap√≥s 5 segundos
            setTimeout(() => {
                hideAlert();
            }, 5000);
        }

        // Ocultar alerta
        function hideAlert() {
            alertContainer.classList.remove('active');
        }

        // Fun√ß√£o para executar comandos diretos (sem formul√°rio)
        function executeCommand(action) {
            showLoading();

            const params = new URLSearchParams();
            params.append('action', action);

            fetch(CGI_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: params.toString()
            })
            .then(response => response.json())
            .then(data => {
                hideLoading();

                if (data.status === 'success') {
                    showAlert('Comando executado com sucesso!', 'success');
                    showResult(`<pre>${data.output || data.message}</pre>`);
                } else {
                    showAlert(data.message, 'error');
                    showResult(`<pre>${data.output || 'Erro ao executar comando'}</pre>`, true);
                }
            })
            .catch(error => {
                hideLoading();
                showAlert('Erro de conex√£o: ' + error.message, 'error');
                console.error('Erro:', error);
            });
        }

        // Fun√ß√£o para submeter formul√°rios
        function submitForm(event, formType) {
            event.preventDefault();
            showLoading();

            const form = event.target;
            const formData = new FormData(form);
            const params = new URLSearchParams();

            // Adicionar a√ß√£o baseada no tipo de formul√°rio
            params.append('action', formType);

            // Adicionar dados do formul√°rio
            for (let [key, value] of formData.entries()) {
                params.append(key, value);
            }

            fetch(CGI_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: params.toString()
            })
            .then(response => response.json())
            .then(data => {
                hideLoading();

                if (data.status === 'success') {
                    showAlert('Opera√ß√£o realizada com sucesso!', 'success');
                    showResult(`<pre>${data.output || data.message}</pre>`);
                    form.reset(); // Limpar formul√°rio
                } else {
                    showAlert(data.message, 'error');
                    showResult(`<pre>${data.output || 'Erro na opera√ß√£o'}</pre>`, true);
                }
            })
            .catch(error => {
                hideLoading();
                showAlert('Erro de conex√£o: ' + error.message, 'error');
                console.error('Erro:', error);
            });
        }

        // Fun√ß√µes de navega√ß√£o
        function showSubmenu(submenuId) {
            hideAlert();
            hideResult();

            document.querySelectorAll('.submenu').forEach(function(sub) {
                sub.classList.remove('active');
            });
            document.querySelectorAll('.instruction-panel').forEach(function(panel) {
                panel.style.display = 'none';
            });
            document.getElementById('main-menu').style.display = 'none';

            var submenu = document.getElementById(submenuId);
            if (submenu) submenu.classList.add('active');
        }

function showMainMenu() {
    // LIMPAR RESULTADOS quando voltar ao menu principal
    const resultContainer = document.querySelector('.result-container');
    if (resultContainer) {
        resultContainer.style.display = 'none';
        resultContainer.innerHTML = '';
    }

    // Limpar loading tamb√©m
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.style.display = 'none';
    }

    hideAlert();

    document.querySelectorAll('.submenu').forEach(function(sub) {
        sub.classList.remove('active');
    });
    document.querySelectorAll('.form-container').forEach(function(form) {
        form.classList.remove('active');
    });
    document.getElementById('main-menu').style.display = 'grid';
    document.querySelectorAll('.instruction-panel').forEach(function(panel) {
        panel.style.display = 'none';
    });
}

        function showInstructionPanel(id) {
            document.querySelectorAll('.instruction-panel').forEach(function(panel) {
                panel.style.display = 'none';
            });
            document.getElementById(id).style.display = 'block';
        }

        function closeInstructionPanel(id) {
            document.getElementById(id).style.display = 'none';
        }

        function showForm(formName) {
            hideAlert();
            hideResult();

            document.querySelectorAll('.form-container').forEach(function(form) {
                form.classList.remove('active');
            });
            var el = document.getElementById(formName + '-form');
            if (el) el.classList.add('active');
            document.querySelectorAll('.instruction-panel').forEach(function(panel) {
                panel.style.display = 'none';
            });
        }

function hideForm() {
    // Esconder todos os formul√°rios
    const forms = document.querySelectorAll('.form-container');
    forms.forEach(form => {
        form.style.display = 'none';
    });

    // Limpar loading
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.style.display = 'none';
    }

    // N√ÉO MEXER NO resultContainer - deixar resultado vis√≠vel
    // Comentado: resultContainer.style.display = 'none';
    // Comentado: resultContainer.innerHTML = '';

    // Limpar campos dos formul√°rios
    const inputs = document.querySelectorAll('input[type="text"], input[type="password"], input[type="date"], textarea, select');
    inputs.forEach(input => {
        if (input.type === 'radio' || input.type === 'checkbox') {
            input.checked = input.defaultChecked;
        } else {
            input.value = '';
        }
    });
}

        // Mapeamento de a√ß√µes para comandos samba-tool
        const commandMapping = {
            'list-users': 'list-users',
            'list-groups': 'list-groups',
            'list-computers': 'list-computers',
            'list-ous': 'list-ous',
            'list-silos': 'list-silos',
            'show-domain-info': 'show-domain-info',
            'show-domain-level': 'show-domain-level',
            'show-fsmo-roles': 'show-fsmo-roles',
            'show-sites': 'show-sites',
            'show-replication-info': 'show-replication-info',
            'active-sessions': 'active-sessions',
            'active-shares': 'active-shares',
            'samba-processes': 'samba-processes',
            'show-shares': 'show-shares',
            'revalidate-shares': 'revalidate-shares',
            'install-admx-w10': 'install-admx-w10',
            'install-admx-w11': 'install-admx-w11',
            'remove-admx': 'remove-admx',
            'update-menu': 'update-menu',
            'show-password-policy': 'show-password-policy',
            'enable-complexity': 'enable-complexity',
            'disable-complexity': 'disable-complexity',
            'sysvol-check': 'sysvol-check',
            'sysvol-reset': 'sysvol-reset',
            'db-check-general': 'db-check-general',
            'db-check-acls': 'db-check-acls',
            'check-acl': 'check-acl'
        };

        // Fun√ß√µes espec√≠ficas para valida√ß√£o
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function validateUsername(username) {
            const re = /^[a-zA-Z0-9._-]+$/;
            return re.test(username) && username.length >= 3;
        }

        // Fun√ß√£o para confirmar a√ß√µes destrutivas
        function confirmAndExecute(action, message) {
            if (confirm(message)) {
                executeCommand(action);
            }
        }

        // Fun√ß√£o para prompts simples
        function promptAndExecute(action, promptMessage) {
            const input = prompt(promptMessage);
            if (input) {
                showLoading();

                const params = new URLSearchParams();
                params.append('action', action);
                params.append('input', input);

                fetch(CGI_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString()
                })
                .then(response => response.json())
                .then(data => {
                    hideLoading();

                    if (data.status === 'success') {
                        showAlert('Opera√ß√£o realizada com sucesso!', 'success');
                        showResult(`<pre>${data.output || data.message}</pre>`);
                    } else {
                        showAlert(data.message, 'error');
                        showResult(`<pre>${data.output || 'Erro na opera√ß√£o'}</pre>`, true);
                    }
                })
                .catch(error => {
                    hideLoading();
                    showAlert('Erro de conex√£o: ' + error.message, 'error');
                });
            }
        }

        // Adicionar valida√ß√£o em tempo real aos formul√°rios
        document.addEventListener('DOMContentLoaded', function() {
            // Valida√ß√£o de email
            const emailInputs = document.querySelectorAll('input[type="email"]');
            emailInputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.value && !validateEmail(this.value)) {
                        this.style.borderColor = '#e74c3c';
                        showAlert('Formato de email inv√°lido', 'warning');
                    } else {
                        this.style.borderColor = '#ddd';
                    }
                });
            });

            // Valida√ß√£o de username
            const usernameInputs = document.querySelectorAll('input[name="username"]');
            usernameInputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.value && !validateUsername(this.value)) {
                        this.style.borderColor = '#e74c3c';
                        showAlert('Nome de usu√°rio deve ter pelo menos 3 caracteres e conter apenas letras, n√∫meros, pontos, underscores e h√≠fens', 'warning');
                    } else {
                        this.style.borderColor = '#ddd';
                    }
                });
            });

            // Adicionar valida√ß√£o para campos obrigat√≥rios
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    const requiredFields = this.querySelectorAll('[required]');
                    let hasErrors = false;

                    requiredFields.forEach(field => {
                        if (!field.value.trim()) {
                            field.style.borderColor = '#e74c3c';
                            hasErrors = true;
                        } else {
                            field.style.borderColor = '#ddd';
                        }
                    });

                    if (hasErrors) {
                        e.preventDefault();
                        showAlert('Por favor, preencha todos os campos obrigat√≥rios', 'error');
                    }
                });
            });
        });

        // Fun√ß√£o para resetar formul√°rios
        function resetForm(formId) {
            const form = document.getElementById(formId);
            if (form) {
                form.reset();
                // Resetar estilos de valida√ß√£o
                const inputs = form.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.style.borderColor = '#ddd';
                });
            }
        }

        // Fun√ß√£o para auto-completar campos baseado em dados anteriores
        function setupAutoComplete() {
            // Implementar auto-complete para usu√°rios, grupos, etc.
            // Pode ser expandido conforme necess√°rio
        }

        // Atalhos de teclado
        document.addEventListener('keydown', function(e) {
            // ESC para fechar formul√°rios
            if (e.key === 'Escape') {
                hideForm();
                hideAlert();
            }

            // Ctrl+Home para voltar ao menu principal
            if (e.ctrlKey && e.key === 'Home') {
                showMainMenu();
            }
        });

        // Fun√ß√£o para exportar resultados
        function exportResults() {
            const resultContent = resultContainer.querySelector('.result-content');
            if (resultContent && resultContent.textContent) {
                const blob = new Blob([resultContent.textContent], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'samba-result-' + new Date().toISOString().slice(0, 19).replace(/:/g, '-') + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }
        }

        // Fun√ß√£o para imprimir resultados
        function printResults() {
            const resultContent = resultContainer.querySelector('.result-content');
            if (resultContent && resultContent.textContent) {
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                        <head>
                            <title>Resultado Samba Admin</title>
                            <style>
                                body { font-family: monospace; margin: 20px; }
                                pre { white-space: pre-wrap; }
                            </style>
                        </head>
                        <body>
                            <h1>Resultado Samba Administration</h1>
                            <p>Data: ${new Date().toLocaleString('pt-BR')}</p>
                            <hr>
                            <pre>${resultContent.textContent}</pre>
                        </body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.print();
            }
        }

        // Inicializa√ß√£o final
        window.addEventListener('load', function() {
            setupAutoComplete();
            console.log('Samba Web Admin Interface carregada com sucesso!');
        });

    </script>
<script>
// Substitua a fun√ß√£o submitForm por esta vers√£o melhorada:
async function submitForm(event, action) {
    event.preventDefault();

    const form = event.target;
    const formData = new FormData(form);
    formData.append('action', action);

    const resultContainer = document.querySelector('.result-container');
    if(resultContainer) {
        resultContainer.style.display = 'none';
        resultContainer.innerHTML = '';
    }

    const loading = document.querySelector('.loading');
    if(loading) loading.style.display = 'block';

    try {
        const response = await fetch('/cgi-bin/samba-admin.cgi', {
            method: 'POST',
            body: new URLSearchParams(formData)
        });

        let text = await response.text();
        let output;

        try {
            output = JSON.parse(text);
        } catch {
            output = { text: text };
        }

        if(resultContainer) {
            resultContainer.style.display = 'block';

            // Melhor processamento do resultado
            let displayText = '';
            if (output.text) {
                displayText = output.text.trim(); // Remove \n e espa√ßos extras
            } else if (typeof output === 'string') {
                displayText = output.trim();
            } else {
                displayText = JSON.stringify(output, null, 2);
            }

            // Se o resultado tem apenas uma linha, exibe simples, sen√£o usa <pre>
            if (displayText.includes('\n') || displayText.length > 100) {
                resultContainer.innerHTML = `<pre>${displayText}</pre>`;
            } else {
                resultContainer.innerHTML = `<div style="font-family: monospace; padding: 10px; background: white; border-radius: 5px;">${displayText}</div>`;
            }
        }
    } catch(e) {
        if(resultContainer) {
            resultContainer.style.display = 'block';
            resultContainer.innerHTML = `<pre>Erro: ${e}</pre>`;
        }
    }

    if(loading) loading.style.display = 'none';
}

// Substitua a fun√ß√£o executeCommand por esta vers√£o melhorada:
async function executeCommand(action) {
    const resultContainer = document.querySelector('.result-container');
    if(resultContainer) {
        resultContainer.style.display = 'none';
        resultContainer.innerHTML = '';
    }

    const loading = document.querySelector('.loading');
    if(loading) loading.style.display = 'block';

    try {
        const response = await fetch('/cgi-bin/samba-admin.cgi', {
            method: 'POST',
            body: new URLSearchParams({action})
        });

        let text = await response.text();
        let output;

        try {
            output = JSON.parse(text);
        } catch {
            output = { text: text };
        }

        if(resultContainer) {
            resultContainer.style.display = 'block';

            // Melhor processamento do resultado
            let displayText = '';
            if (output.text) {
                displayText = output.text.trim(); // Remove \n e espa√ßos extras
            } else if (typeof output === 'string') {
                displayText = output.trim();
            } else {
                displayText = JSON.stringify(output, null, 2);
            }

            // Se o resultado tem m√∫ltiplas linhas, usa <pre>, sen√£o exibe simples
            if (displayText.includes('\n')) {
                // Para listas, formatar melhor
                const lines = displayText.split('\n').filter(line => line.trim());
                if (lines.length > 1) {
                    const formattedList = lines.map(line => `‚Ä¢ ${line.trim()}`).join('<br>');
                    resultContainer.innerHTML = `<div style="font-family: 'Segoe UI', sans-serif; line-height: 1.6;">${formattedList}</div>`;
                } else {
                    resultContainer.innerHTML = `<div style="font-family: monospace; padding: 10px; background: white; border-radius: 5px;">${displayText}</div>`;
                }
            } else {
                resultContainer.innerHTML = `<div style="font-family: monospace; padding: 10px; background: white; border-radius: 5px; font-size: 16px; color: #2c3e50;">${displayText}</div>`;
            }
        }
    } catch(e) {
        if(resultContainer) {
            resultContainer.style.display = 'block';
            resultContainer.innerHTML = `<pre>Erro: ${e}</pre>`;
        }
    }

    if(loading) loading.style.display = 'none';
}

function showConfirmation(message, callback) {
    const overlay = document.getElementById('confirmOverlay');
    const messageEl = document.getElementById('confirmMessage');
    const yesBtn = document.getElementById('confirmYes');
    const noBtn = document.getElementById('confirmNo');

    messageEl.innerHTML = message;
    overlay.classList.add('active');

    // Remover event listeners anteriores
    yesBtn.onclick = null;
    noBtn.onclick = null;

    yesBtn.onclick = function() {
        overlay.classList.remove('active');
        callback(true);
    };

    noBtn.onclick = function() {
        overlay.classList.remove('active');
        callback(false);
    };
}

// Fun√ß√£o para expira√ß√£o de senha (sim/n√£o direto)
function handlePasswordExpiry(event) {
    event.preventDefault();
    const username = document.getElementById('expiry-username').value;

    if (!username) {
        showAlert('Por favor, digite o nome do usu√°rio', 'error');
        return;
    }

    // Usar o modal de confirma√ß√£o que j√° existe
    const overlay = document.getElementById('confirmOverlay');
    const messageEl = document.getElementById('confirmMessage');
    const yesBtn = document.getElementById('confirmYes');
    const noBtn = document.getElementById('confirmNo');

    messageEl.innerHTML = `<strong>CONFIGURAR EXPIRA√á√ÉO DE SENHA</strong><br><br>Usu√°rio: "${username}"<br><br>A senha deste usu√°rio N√ÉO deve mais expirar?<br><br>‚Ä¢ <strong>SIM</strong> = Senha nunca expira (--noexpiry)<br>‚Ä¢ <strong>N√ÉO</strong> = Senha expira em 90 dias (padr√£o do dom√≠nio)`;
    overlay.classList.add('active');

    // Remover event listeners anteriores para evitar conflitos
    yesBtn.onclick = null;
    noBtn.onclick = null;

    yesBtn.onclick = function() {
        overlay.classList.remove('active');
        
        // Se confirmou SIM, senha n√£o expira
        showLoading();
        
        const formData = new URLSearchParams();
        formData.append('action', 'set-no-expiry');
        formData.append('username', username);

        fetch('/cgi-bin/samba-admin.cgi', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            hideLoading();
            showResult(`<pre>${data}</pre>`);
            showAlert(`‚úì Senha de "${username}" configurada para NUNCA EXPIRAR`, 'success');
            
            // Limpar o formul√°rio
            document.getElementById('expiry-username').value = '';
        })
        .catch(error => {
            hideLoading();
            showAlert('Erro: ' + error.message, 'error');
        });
    };

    noBtn.onclick = function() {
        overlay.classList.remove('active');
        
        // Se cancelou (N√ÉO), define prazo padr√£o
        showLoading();
        
        const formData = new URLSearchParams();
        formData.append('action', 'set-default-expiry');
        formData.append('username', username);

        fetch('/cgi-bin/samba-admin.cgi', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            hideLoading();
            showResult(`<pre>${data}</pre>`);
            showAlert(`‚úì Senha de "${username}" vai expirar em 90 dias (padr√£o)`, 'success');
            
            // Limpar o formul√°rio
            document.getElementById('expiry-username').value = '';
        })
        .catch(error => {
            hideLoading();
            showAlert('Erro: ' + error.message, 'error');
        });
    };
}

function confirmDeleteOU(event) {
    event.preventDefault();
    const ou = document.getElementById('delete-ou-name').value;

    showConfirmation(`Excluir a OU "${ou}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-ou');
        }
    });
}

function confirmDeleteShare(event) {
    event.preventDefault();
    const share = document.getElementById('delete-share-name').value;

    showConfirmation(`Excluir o compartilhamento "${share}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-share');
        }
    });
}

function confirmDeleteSilo(event) {
    event.preventDefault();
    const silo = document.getElementById('delete-silo-name').value;

    showConfirmation(`Tem certeza que deseja excluir o silo "${silo}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-silo');
        }
    });
}

function confirmDeleteComputer(event) {
    event.preventDefault();
    const computer = document.getElementById('delete-computer-name').value;

    if (!computer) {
        showAlert('Por favor, digite o nome do computador', 'error');
        return;
    }

    showConfirmation(`Tem certeza que deseja excluir o computador "${computer}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-computer');
        }
    });
}

function confirmDeleteGroup(event) {
    event.preventDefault();
    const group = document.getElementById('delete-group-name').value;

    if (!group) {
        showAlert('Por favor, digite o nome do grupo', 'error');
        return;
    }

    showConfirmation(`Deseja realmente excluir o grupo "${group}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-group');
        }
    });
}

function confirmDeleteUser(event) {
    event.preventDefault();
    const username = document.getElementById('delete-username').value;

    if (!username) {
        showAlert('Por favor, digite o nome do usu√°rio', 'error');
        return;
    }

    showConfirmation(`Tem certeza que deseja deletar o usu√°rio "${username}"?`, function(confirmed) {
        if (confirmed) {
            submitForm(event, 'delete-user');
        }
    });
}

// Fun√ß√£o para mostrar/ocultar campo de data
function toggleExpiryFields() {
    const dateField = document.getElementById('date-field');
    const expiryType = document.querySelector('input[name="expiry-type"]:checked').value;

    if (expiryType === 'date') {
        dateField.style.display = 'block';
        document.getElementById('account-expiry-date').required = true;
    } else {
        dateField.style.display = 'none';
        document.getElementById('account-expiry-date').required = false;
    }
}

// Fun√ß√£o para definir expira√ß√£o da conta (modificada)
function handleAccountExpiry(event) {
    event.preventDefault();
    const username = document.getElementById('account-expiry-username').value;
    const expiryType = document.querySelector('input[name="expiry-type"]:checked').value;
    let expiryDate = document.getElementById('account-expiry-date').value;

    if (!username) {
        showAlert('Por favor, digite o nome do usu√°rio', 'error');
        return;
    }

    if (expiryType === 'date' && !expiryDate) {
        showAlert('Por favor, selecione a data de expira√ß√£o', 'error');
        return;
    }

    let confirmMessage;
    if (expiryType === 'never') {
        confirmMessage = `Definir que a CONTA do usu√°rio "${username}" NUNCA expire?`;
        expiryDate = 'never';
    } else {
        // Converter DD/MM/YYYY para YYYY-MM-DD se necess√°rio
        if (expiryDate.includes('/')) {
            const parts = expiryDate.split('/');
            if (parts.length === 3) {
                expiryDate = `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;
            }
        }
        confirmMessage = `Definir que a CONTA do usu√°rio "${username}" expire em ${expiryDate}?`;
    }

    showConfirmation(confirmMessage, function(confirmed) {
        if (confirmed) {
            const loading = document.querySelector('.loading');
            if(loading) loading.style.display = 'block';

            const formData = new FormData();
            formData.append('action', 'set-account-expiry');
            formData.append('username', username);
            formData.append('expiry-date', expiryDate);

            fetch('/cgi-bin/samba-admin.cgi', {
                method: 'POST',
                body: new URLSearchParams(formData)
            })
            .then(response => response.text())
            .then(data => {
                if(loading) loading.style.display = 'none';

                const resultContainer = document.querySelector('.result-container');
                if(resultContainer) {
                    resultContainer.style.display = 'block';
                    resultContainer.innerHTML = `<pre>${data}</pre>`;
                }

                showAlert('Comando executado', 'success');
            })
            .catch(error => {
                if(loading) loading.style.display = 'none';
                showAlert('Erro: ' + error.message, 'error');
            });
        }
    });
}

// Fun√ß√£o para voltar para Configura√ß√µes do Dom√≠nio
function backToDomainSettings() {
    // Limpar resultados
    const resultContainer = document.querySelector('.result-container');
    if (resultContainer) {
        resultContainer.style.display = 'none';
        resultContainer.innerHTML = '';
    }

    // Limpar loading
    const loading = document.querySelector('.loading');
    if (loading) {
        loading.style.display = 'none';
    }

    hideAlert();

    // Esconder todos os formul√°rios
    document.querySelectorAll('.form-container').forEach(function(form) {
        form.classList.remove('active');
    });

    // Mostrar o submenu de configura√ß√µes do dom√≠nio
    showSubmenu('domain-settings');
}

</script>
<div class="loading" style="display:none"><div class="spinner"></div>Carregando...</div>
<div class="result-container" style="display:none"></div>
    <div id="confirmOverlay" class="confirm-overlay">
    <div class="confirm-box">
        <div id="confirmMessage" class="confirm-message">Deseja realizar esta a√ß√£o?</div>
        <div class="confirm-buttons">
            <button id="confirmYes" class="confirm-btn confirm-btn-yes">Sim</button>
            <button id="confirmNo" class="confirm-btn confirm-btn-no">N√£o</button>
        </div>
    </div>
</div>
</body>
</html>
