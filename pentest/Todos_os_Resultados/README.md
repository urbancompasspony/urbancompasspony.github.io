# Project Pandora - Black Box Penetration Testing

## 📋 Sobre o Projeto

O **Project Pandora** é uma ferramenta automatizada de pentest Black Box que realiza avaliações de segurança abrangentes em redes corporativas. Utiliza metodologia "Double Blind" para identificar vulnerabilidades em sistemas sem conhecimento prévio da infraestrutura.

## 🎯 Tipos de Arquivos Gerados

### Arquivo Principal: `IP_ADDRESS`
```
172.20.0.4
```
**Descrição**: Arquivo de resultado consolidado contendo toda a análise de vulnerabilidades do host.

**Conteúdo**:
- Resultados completos do scan de vulnerabilidades
- Detecção de serviços ativos
- Scripts NSE executados (vuln, safe, discovery, auth, brute)
- Reconnaissance adicional (OS detection, traceroute)
- Análise de portas TCP e UDP abertas

### Arquivo Temporário: `IP_ADDRESS_tcp_full`
```
172.20.0.4_tcp_full
```
**Descrição**: Resultado do scan TCP completo (portas 1-65535).

**Conteúdo**:
- Scan de todas as 65535 portas TCP
- Identificação de portas abertas
- Usado como base para análise detalhada posterior
- **Status**: Arquivo temporário removido após processamento

### Arquivo Temporário: `IP_ADDRESS_udp_critical`
```
172.20.0.4_udp_critical
```
**Descrição**: Resultado do scan UDP das 30 portas críticas corporativas.

**Conteúdo**:
- Scan das portas UDP mais importantes para ambiente corporativo
- Portas incluídas: `53,67,68,88,123,137,138,161,162,514,520,1161,1434,1645,1646,1701,1812,1813,3074,4500,5060,5061,8161,10161,10162,69,1069,8069,500,27015`
- **Status**: Arquivo temporário removido após processamento

## 🔍 Processo de Scanning

### Fase 1: Discovery
- Descoberta de hosts ativos na rede `/24`
- Remoção de IPs da blacklist
- Cache de 48h para evitar rescans

### Fase 2: Port Scanning
1. **TCP Full Scan**: Varredura completa de portas 1-65535
2. **UDP Critical Scan**: Varredura das 30 portas UDP críticas

### Fase 3: Vulnerability Assessment
- Apenas executado se portas abertas forem encontradas
- Scripts NSE: `vuln`, `safe`, `discovery`, `auth`, `brute`
- Timeout de scripts: 300 segundos
- Stealth level: T2 (firewall-friendly)

### Fase 4: Reconnaissance
- Detecção de OS
- Traceroute para mapeamento de rede
- Análise adicional para hosts interessantes

## 📊 Estrutura de Diretórios (na versão de produção)

```
/Pentests/
├── Todos_os_Resultados/
│   └── DD_MM_YY-HH:MM/
│       ├── 172.20.0.4           # Resultado final
│       ├── 172.20.0.5           # Resultado final
│       └── relatorio.html       # Relatório HTML
├── Ataque_Bem-Sucedido/
│   ├── RESUMO_172.20.0.4.txt    # Vulnerabilidades encontradas
│   └── index.html               # Índice de vulnerabilidades
└── Historico/
    └── DD_MM_YY-HH:MM.zip       # Arquivo compactado
```

## 🚨 Detecção de Vulnerabilidades

O sistema identifica vulnerabilidades procurando por:
- `VULNERABLE`
- `Exploitable`
- `CVE-`
- `EXPLOIT`
- `CRITICAL`
- `HIGH`
- `appears to be vulnerable`

Quando vulnerabilidades são encontradas:
1. Arquivo copiado para `/Ataque_Bem-Sucedido/`
2. Resumo detalhado gerado (`RESUMO_IP.txt`)
3. Notificação enviada via ntfy

## ⚙️ Configurações

- **Jobs Paralelos**: Máximo 2 (stealth mode)
- **Timeout Total**: 2 horas
- **Rate Limiting**: 1000 pps TCP, 500 pps UDP
- **Retries**: 1 tentativa máxima
- **Cache**: 48 horas para evitar rescans

## 🔒 Metodologia Black Box

- **Sem conhecimento prévio** da infraestrutura
- **Double Blind Assessment**
- **Firewall-friendly** (T2 timing)
- **Cobertura completa** TCP + UDP crítico
- **Stealth approach** para evitar detecção
